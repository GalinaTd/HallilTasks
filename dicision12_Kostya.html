<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Lesson12</title> 
</head>

<style type="text/css">
.box{
    width: 100px;
    height: 100px;
    border: 1px solid;
    font-size: 24px;
    display: flex;
    align-content: center;
    justify-content: center;
    float:left;
    margin-right: 15px;
    cursor: pointer;
    flex-wrap: wrap;
}
.box span {
    width: 100%;
    text-align: center;
}
.box button {
    width: 40%;
}

[contenteditable="true"] {
      min-height: 30px;
      font-size: 20px;
      line-height: 30px;
      margin-top: 200px;
      margin-bottom: 30px;
      border: 1px solid;
    }
    .letter {
      width: 50px;
      height: 50px;
      text-align: center;
      line-height: 50px;
      border: 1px solid;
      margin-right: 15px;
      margin-bottom: 15px;
      float: left;
    }

</style>

<body>
    <h1>Занятие 12. Работа с DOM, события, BOM</h1>

    <div class="container">
     <div class="box">
         <span>0</span>
         <button type="button" data-action="plus">+</button>
         <button type="button" data-action="minus">-</button>
     </div>
     <div class="box">
        <span>0</span>
        <button type="button" data-action="plus">+</button>
        <button type="button" data-action="minus">-</button>
    </div>
    <div class="box">
        <span>0</span>
        <button type="button" data-action="plus">+</button>
        <button type="button" data-action="minus">-</button>
    </div>
    <div class="box">
        <span>0</span>
        <button type="button" data-action="plus">+</button>
        <button type="button" data-action="minus">-</button>
    </div>
    <div class="box">
        <span>0</span>
        <button type="button" data-action="plus">+</button>
        <button type="button" data-action="minus">-</button>
    </div>
    </div>

    <div class="task">
        <div class="content" contenteditable="true"></div>        
    </div>

    <script>
         'use strict';

         const $task = document.querySelector('.task');
         const $content = document.querySelector('.content');

         $content.addEventListener('input', function() {            
                 this.textContent.split('').forEach(function(el) {                
                 let $div = document.createElement('div');
                 $div.classList.add("letter");
                 //$div.innerHTML = this.textContent[this.textContent.length-1];
                 $div.innerHTML = el;

                $task.append($div);
             })
         })


         /* клик по квадрату и увелеичение счетчика
         document.querySelectorAll('.box')
            .forEach(function(box){
                box.addEventListener('click',function(){
                    this.textContent++;
                })

            })
            */
            //увеличение/уменьшение счетчика по клику на кнопки+-

            // closest - поиск ближайшего родителя по заданному селектору
            document.querySelectorAll('.box')
              .forEach(function(box){
                  box.querySelector('[data-action="plus"]') 
                     .addEventListener('click', function () {                      
                         this.closest('.box').querySelector('span').textContent++;//ищем в родителе box селектор спан
                  });                 
                  box.querySelector('[data-action="minus"]') 
                     .addEventListener('click', function () {                      
                         this.closest('.box').querySelector('span').textContent--;
                  });      
                 

            });

            //const url = location.search; // в раб проектах получаем сразу часть урла с параметрами
            //console.log(location.search);
            
            const url = ' https://ithillel.ua/?utm_source=%D0%9A%D0%B0%D1%80%D0%BB%20%D1%83%20%D0%9A%D0%BB%D0%B0%D1%80%D1%8B%20%D1%83%D0%BA%D1%80%D0%B0%D0%BB%20%D0%BA%D0%BE%D1%80%D0%B0%D0%BB%D0%BB%D1%8B&utm_medium=,%20%D0%B0%20%D0%9A%D0%BB%D0%B0%D1%80%D0%B0%20%D1%83%20%D0%9A%D0%B0%D1%80%D0%BB%D0%B0%20%D1%83%D0%BA%D1%80%D0%B0%D0%BB%D0%B0%20%D0%BA%D0%BB%D0%B0%D1%80%D0%BD%D0%B5%D1%82.&utm_campaign=%D0%9A%D0%BE%D1%80%D0%BE%D0%BB%D0%B5%D0%B2%D0%B0%20%D0%9A%D0%BB%D0%B0%D1%80%D0%B0%20%D0%BA%D0%B0%D0%B2%D0%B0%D0%BB%D0%B5%D1%80%D0%B0&utm_term=%D0%9A%D0%B0%D1%80%D0%BB%D0%B0%20%D1%81%D1%82%D1%80%D0%BE%D0%B3%D0%BE%20%D0%BA%D0%B0%D1%80%D0%B0%D0%BB%D0%B0&utm_content=%D0%B7%D0%B0%20%D0%BA%D1%80%D0%B0%D0%B6%D1%83%20%D0%BA%D0%BE%D1%80%D0%B0%D0%BB%D0%BB%D0%BE%D0%B2';
            
            // извлечение из урла параметров slice - созд новый массив с указ позиции, ищу поз в которой ?
            function getQParamsFromUrl (queryStr) {
               let obj = {};
                queryStr.slice(queryStr.indexOf('?')+1).split('&')
                    .map(function(e) {
                        return e.split('=');
                    })
                    .forEach(function (e) {
                        const key = e[0];
                        const value =decodeURIComponent(e[1]);

                        obj[key] = value;
                    })
                    return obj;

            }
            //console.log(getQParamsFromUrl(url));


    </script>
</body>