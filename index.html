<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Lesson17</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
</head>

<style type="text/css">
</style>

<script>
  'use strict';

  //1 задание аналог метода bind своими руками
  const bind = function (fn, context) {
    // преобраз. псевдомассива arguments в новый массив Array и обрезаем функцию и контекст
    const bindArgs = [].slice.call(arguments, 2);
    //console.log(bindArgs);
    return function () {
      // преобраз. все аргументы функции в новый массив
      const fnArgs = [].slice.call(arguments);
      // собираем все аргументы и вызываем функцию с заданным контекстом и аргументами              
      return fn.apply(context, bindArgs.concat(fnArgs));
    };
  };

  //функция которая суммирует все аргументы и прибавляет к начальной сумме
  const sum = function () {
    return [].reduce.call(arguments, function (result, current) {
      return result + current;
    }, this.sum);
  };

  //метод bind
  const bindSumNative = sum.bind({ sum: 50 }, 20, 30, 10);
  console.log(bindSumNative(80,70));

  // проверка работы ручного метода bind
  const bindedSum = bind(sum, { sum: 50 }, 20, 30, 10); // {sum: 10} => thisArg с которого начинается суммирование
  console.log(bindedSum(80, 70));

  function foo(phrase = 'Hello', symbol) {
      return `${phrase} ${this.name} ${symbol}`;
  };

  const admin = {
    name: 'Alex',
    foo: foo
  };
 // 2-я проверка ручного bind
  const baz = bind(foo, admin, 'How are you', '?'); //запуск foo с контекстом admin и новой фразой
  console.log(baz());

  // 2 задание аналог метода map своими руками
  const map = function (arr, callback, thisArg) {
    let results = []; // новый массив для записи элементов после работы функции 
    let elNew; // новый элемент массива
    for (let i = 0; i < arr.length; i = i + 1) {
      elNew = callback.call(thisArg, arr[i], i, arr); //запуск функции для преобразования элемента
      results.push(elNew); //добавляем новый элемент в массив с помощью push
    }
    return results;
  };

  const arr = [1, 2, 3, 4, 5];
  
  //пример метода map с возведением в степень
  const arrPowNative = arr.map(function (el, ind) {
    return Math.pow(el, ind);
  });
  console.log(arrPowNative);

  // пример ручной map с возведением в степень
  const arrPow = map(arr, function (el, ind) {
    return Math.pow(el, ind);
  });
  console.log(arrPow);
  
  // пример ручной map с переводом массива из градусов цельсия в массив по фарингейту
  const celsius = [-15, -5, 0, 10, 16, 20, 24, 32];
  const fahrenheit = map(celsius, function (el) {
    return el * 1.8 + 32;
  });

  console.log(celsius);
  console.log(fahrenheit);

  

</script>