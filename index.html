<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title>Lesson21</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
</head>

<style type="text/css">
</style>

<body>
    <script>
        'use strict';

        function Student(firstName, lastName, yearBirth) {
            this.firstName = firstName;
            this.lastName = lastName;
            this.yearBirth = yearBirth;
            this.attendance = new Array(25);// заполн undefined для перебора for of или for           
            this.score = [];

        }

        Student.prototype.showFullName = function () {
            return `${this.firstName} ${this.lastName}`;
        }
        // метод фикс присутствие на занятии
        Student.prototype.presence = function () {
            for (let i = 0; i < this.attendance.length; i++) {
                if (this.attendance[i] === undefined) {
                    this.attendance[i] = true; 
                    return this.attendance;                  
                } 
                
            }           
            return 'в массиве не места'; 
        }
        // метод фикс прогул
        Student.prototype.absent = function () {
            for (let i = 0; i < this.attendance.length; i++) {
                if (this.attendance[i] === undefined) {
                    this.attendance[i] = false;                  
                    return this.attendance;            
                }
                
            }
            return 'в массиве не места';    
        }
        // добавление оценки в массив оценок
        Student.prototype.addScore = function (newScore) {
            return this.score.push(newScore);
        }

        // расчет возраста
        Student.prototype.calcAge = function () {
            const d = new Date();
            const curYear = d.getFullYear();
            return curYear - this.yearBirth;
        }

        // расчет среднего балла студента
        Student.prototype.avgScore = function () {
            let sum = 0;
            this.score.reduce(function (prvValue, curVal, ind) {
                sum = prvValue + curVal;
                return sum
            })
            return sum / this.score.length;
        }
        // расчет 
        Student.prototype.summary = function () {
            let sumPresence = 0;
            this.attendance.forEach(function (el) {
                if (el === true) {
                    sumPresence++;
                }
            })

            const avgAttendance = sumPresence / this.attendance.length;
            const avgScore = this.avgScore();
            if (avgAttendance > 0.9 && avgScore > 90) {
                return `${avgAttendance} ${avgScore} Ух ты какой молодчинка!`;
            } else if (avgAttendance > 0.9 || avgScore > 90) {
                return `${avgAttendance} ${avgScore} Норм, но можно лучше`;
            } else {
                return `${avgAttendance} ${avgScore} Редиска!`;
            }

        }


        const student1 = new Student('Natali', 'Petrova', 2000);
        const student2 = new Student('Ivan', 'Popov', 2003);

        // заполнение массивов для теста
        for (let i = 0; i <= 24; i++) {
            if (i % 5 === 0) {
                student1.absent(); //прогул                 
                student2.presence(); //был на занятии               
            } else {
                student1.presence(); //был на занятии
                student2.absent(); //прогул 
                if (i % 2 === 0) {
                    student1.addScore(100); // добавление оценки
                    student2.addScore(50);
                } else {
                    student1.addScore(90);
                    student2.addScore(70);
                }
            }
        }

        console.log(student1);
        console.log('Возраст студента -' + student1.calcAge());
        console.log(student1.score);
        console.log(student1.showFullName() + ' cредний балл - ' + student1.avgScore());
        console.log(student1.attendance);
        console.log(student1.summary());

        console.log(student2);
        console.log('Возраст студента -' + student2.calcAge());
        console.log(student2.score);
        console.log(student2.showFullName() + ' cредний балл - ' + student2.avgScore());
        console.log(student2.attendance);
        console.log(student2.summary());



    </script>
</body>